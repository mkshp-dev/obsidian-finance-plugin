"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[5740],{4473:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"prices","title":"Prices","description":"This page covers how to update commodity prices using bean-price and how to avoid common PowerShell pitfalls.","source":"@site/docs/prices.md","sourceDirName":".","slug":"/prices","permalink":"/obsidian-finance-plugin/docs/prices","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/prices.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Commodities","permalink":"/obsidian-finance-plugin/docs/commodities"},"next":{"title":"Transactions","permalink":"/obsidian-finance-plugin/docs/transactions"}}');var c=i(4848),r=i(8453);const t={sidebar_position:6},o="Prices",d={},a=[];function l(e){const n={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"prices",children:"Prices"})}),"\n",(0,c.jsxs)(n.p,{children:["This page covers how to update commodity prices using ",(0,c.jsx)(n.code,{children:"bean-price"})," and how to avoid common PowerShell pitfalls."]}),"\n",(0,c.jsxs)(n.p,{children:["What ",(0,c.jsx)(n.code,{children:"bean-price"})," does"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"bean-price"})," evaluates a Beancount price expression or generates price directives for a ledger. The plugin uses it to produce ",(0,c.jsx)(n.code,{children:"dependencies/prices.beancount"}),"."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"WSL vs PowerShell"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Running ",(0,c.jsx)(n.code,{children:"bean-price"})," under WSL works and the shell redirection ",(0,c.jsx)(n.code,{children:">>"})," produces clean UTF-8 text:"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"bean-price ../../../ledger.beancount >> ../../../dependencies/prices.beancount\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["In PowerShell, using ",(0,c.jsx)(n.code,{children:">>"})," can cause encoding or BOM issues because PowerShell may re-encode output (Out-File uses UTF-16 by default). This leads to \u201cgarbage\u201d in the file."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Safe PowerShell options"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Use ",(0,c.jsx)(n.code,{children:"Start-Process"})," with redirection:"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-powershell",children:"Start-Process -FilePath 'bean-price.exe' -ArgumentList '..\\..\\..\\ledger.beancount' -RedirectStandardOutput '..\\..\\..\\dependencies\\prices.beancount' -NoNewWindow -Wait\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Or pipe through ",(0,c.jsx)(n.code,{children:"Out-File"})," with explicit UTF-8 encoding:"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-powershell",children:"bean-price.exe ..\\..\\..\\ledger.beancount 2>&1 | Out-File -FilePath ..\\..\\..\\dependencies\\prices.beancount -Encoding utf8 -Append\n"})}),"\n",(0,c.jsx)(n.p,{children:"Recommended approach: backend helper"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["The plugin includes (or can call) a backend helper that runs ",(0,c.jsx)(n.code,{children:"bean-price"})," via Python and writes ",(0,c.jsx)(n.code,{children:"dependencies/prices.beancount"})," with ",(0,c.jsx)(n.code,{children:"encoding='utf-8'"}),". This avoids shell-specific quirks. See ",(0,c.jsx)(n.code,{children:"run_bean_price_and_write"})," in ",(0,c.jsx)(n.code,{children:"src/backend/journal_api.py"})," and the API endpoint ",(0,c.jsx)(n.code,{children:"/prices/update"})," (if present)."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Example: call the plugin endpoint"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-http",children:'POST /prices/update\nContent-Type: application/json\n{\n  "beancount_path": "ledger.beancount",\n  "out_path": "dependencies/prices.beancount",\n  "timeout": 120\n}\n'})}),"\n",(0,c.jsxs)(n.p,{children:["The endpoint runs ",(0,c.jsx)(n.code,{children:"bean-price"})," and writes UTF-8 output to the specified file, returning stdout/stderr for diagnostics."]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var s=i(6540);const c={},r=s.createContext(c);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);
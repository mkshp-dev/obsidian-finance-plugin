"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[18],{811:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"queries/bql","title":"BQL Queries","description":"The plugin brings the full power of Beancount Query Language (BQL) directly into Obsidian. You can execute SQL-like queries against your financial data and display the results in your notes.","source":"@site/docs/queries/bql.md","sourceDirName":"queries","slug":"/queries/bql","permalink":"/obsidian-finance-plugin/docs/queries/bql","draft":false,"unlisted":false,"editUrl":"https://github.com/mkshp-dev/obsidian-finance-plugin/tree/dev/docs-site/docs/queries/bql.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Settings","permalink":"/obsidian-finance-plugin/docs/configuration/settings"},"next":{"title":"Troubleshooting","permalink":"/obsidian-finance-plugin/docs/queries/troubleshooting"}}');var r=s(4848),t=s(8453);const c={sidebar_position:1},l="BQL Queries",a={},o=[{value:"\ud83d\udcca BQL Code Blocks",id:"-bql-code-blocks",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Features",id:"features",level:3},{value:"Common Examples",id:"common-examples",level:3},{value:"\ud83d\udcc8 Advanced Query Examples",id:"-advanced-query-examples",level:2},{value:"Investment Tracking",id:"investment-tracking",level:3},{value:"Budget Analysis",id:"budget-analysis",level:3},{value:"Account Analysis",id:"account-analysis",level:3},{value:"Multi-Currency",id:"multi-currency",level:3},{value:"Date Range Queries",id:"date-range-queries",level:3},{value:"\ud83d\udcb0 Inline BQL Queries",id:"-inline-bql-queries",level:2},{value:"Direct Queries",id:"direct-queries",level:3},{value:"Shorthand Templates",id:"shorthand-templates",level:3},{value:"1. Setup Template",id:"1-setup-template",level:4},{value:"2. Configure",id:"2-configure",level:4},{value:"3. Use",id:"3-use",level:4}];function d(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"bql-queries",children:"BQL Queries"})}),"\n",(0,r.jsxs)(n.p,{children:["The plugin brings the full power of ",(0,r.jsx)(n.strong,{children:"Beancount Query Language (BQL)"})," directly into Obsidian. You can execute SQL-like queries against your financial data and display the results in your notes."]}),"\n",(0,r.jsx)(n.p,{children:"The plugin supports two distinct modes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Code Blocks"}),": For detailed analysis and tables."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Inline Queries"}),": For embedding live values into your text."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"-bql-code-blocks",children:"\ud83d\udcca BQL Code Blocks"}),"\n",(0,r.jsxs)(n.p,{children:["Use standard Markdown code blocks with the ",(0,r.jsx)(n.code,{children:"bql"})," language identifier to create formatted, interactive tables."]}),"\n",(0,r.jsx)(n.admonition,{title:"Important",type:"warning",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Single-Line Queries Only"}),": BQL queries must be written on a single line. Multi-line queries will only execute the first line and ignore subsequent lines."]})}),"\n",(0,r.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"```bql\nSELECT account, sum(position) WHERE account ~ '^Expenses' GROUP BY account\n```\n"})}),"\n",(0,r.jsx)(n.h3,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Interactive Results"}),": Sortable columns and responsive layout."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tools"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Refresh (\u27f3)"}),": Re-run the query to get the latest data."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Copy (\ud83d\udccb)"}),": Copy the raw CSV results to your clipboard."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Export (\ud83d\udce4)"}),": Download results as a CSV file."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Toggle View"}),": Hide the query code to show only the results table (configurable in Settings)."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"common-examples",children:"Common Examples"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"List All Accounts:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account GROUP BY account ORDER BY account\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Recent Transactions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT date, payee, narration, position ORDER BY date DESC LIMIT 20\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Monthly Expenses:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT year, month, sum(position) WHERE account ~ '^Expenses' GROUP BY year, month ORDER BY year DESC, month DESC\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Current Account Balances:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, sum(position) WHERE account ~ '^Assets' GROUP BY account ORDER BY account\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Top Expenses by Category:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, sum(position) WHERE account ~ '^Expenses' GROUP BY account ORDER BY sum(position) DESC LIMIT 10\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-advanced-query-examples",children:"\ud83d\udcc8 Advanced Query Examples"}),"\n",(0,r.jsx)(n.h3,{id:"investment-tracking",children:"Investment Tracking"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Current Stock Holdings:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, currency, units(sum(position)) WHERE account ~ '^Assets:Brokerage' GROUP BY account, currency\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Investment Performance (Market Value):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, cost(sum(position)), convert(sum(position), 'USD') WHERE account ~ '^Assets:Brokerage' GROUP BY account\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Capital Gains Summary:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT year, sum(position) WHERE account ~ '^Income:CapitalGains' GROUP BY year ORDER BY year DESC\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dividend Income:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT date, payee, position WHERE account ~ '^Income:Dividends' ORDER BY date DESC\n"})}),"\n",(0,r.jsx)(n.h3,{id:"budget-analysis",children:"Budget Analysis"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Year-over-Year Expense Comparison:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT year, month, convert(sum(position), 'USD') WHERE account ~ '^Expenses' GROUP BY year, month ORDER BY year, month\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Spending by Merchant:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT payee, sum(position) WHERE account ~ '^Expenses' GROUP BY payee ORDER BY sum(position) DESC LIMIT 20\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Tag-Based Expense Tracking:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT date, payee, narration, position WHERE 'vacation' IN tags ORDER BY date DESC\n"})}),"\n",(0,r.jsx)(n.h3,{id:"account-analysis",children:"Account Analysis"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Net Worth Trend:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT year, month, convert(sum(position), 'USD') WHERE account ~ '^(Assets|Liabilities)' GROUP BY year, month ORDER BY year, month\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Savings Rate Calculation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT month, (SELECT convert(sum(position), 'USD') WHERE account ~ '^Income' AND month = parent.month) AS income, (SELECT convert(sum(position), 'USD') WHERE account ~ '^Expenses' AND month = parent.month) AS expenses WHERE year = 2023 GROUP BY month\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Credit Card Balance History:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT date, balance WHERE account = 'Liabilities:CreditCard' ORDER BY date DESC LIMIT 50\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multi-currency",children:"Multi-Currency"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Non-USD Holdings:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, currency, sum(position) WHERE NOT currency = 'USD' AND account ~ '^Assets' GROUP BY account, currency\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Currency Conversion:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, units(sum(position)), convert(sum(position), 'USD') WHERE account ~ '^Assets' GROUP BY account\n"})}),"\n",(0,r.jsx)(n.h3,{id:"date-range-queries",children:"Date Range Queries"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"This Month's Transactions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT date, payee, narration, position WHERE date >= 2026-02-01 AND date <= 2026-02-29 ORDER BY date DESC\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Quarter Performance:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, sum(position) WHERE account ~ '^Income' AND date >= 2026-01-01 AND date <= 2026-03-31 GROUP BY account\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Last 90 Days Activity:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT account, sum(position) WHERE account ~ '^Expenses' AND date >= today() - 90 GROUP BY account ORDER BY sum(position) DESC\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-inline-bql-queries",children:"\ud83d\udcb0 Inline BQL Queries"}),"\n",(0,r.jsxs)(n.p,{children:["Embed live financial values directly in your sentences using single backticks. This is perfect for daily journaling (e.g., ",(0,r.jsx)(n.em,{children:'"My checking balance is currently..."'}),")."]}),"\n",(0,r.jsx)(n.h3,{id:"direct-queries",children:"Direct Queries"}),"\n",(0,r.jsxs)(n.p,{children:["Write a full BQL query inside backticks starting with ",(0,r.jsx)(n.code,{children:"bql:"}),":"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["My net worth is ",(0,r.jsx)(n.code,{children:"bql:SELECT convert(sum(position), 'USD') WHERE account ~ '^Assets'"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"shorthand-templates",children:"Shorthand Templates"}),"\n",(0,r.jsxs)(n.p,{children:["For complex or frequently used queries, use the ",(0,r.jsx)(n.strong,{children:"Shorthand System"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"1-setup-template",children:"1. Setup Template"}),"\n",(0,r.jsxs)(n.p,{children:["Create a note (e.g., ",(0,r.jsx)(n.code,{children:"BQL_Shortcuts.md"}),") and define queries like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"## WORTH: Net Worth\n```bql-shorthand\nSELECT convert(sum(position), 'USD') WHERE account ~ '^(Assets|Liabilities)'\n```\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-configure",children:"2. Configure"}),"\n",(0,r.jsxs)(n.p,{children:["Go to ",(0,r.jsx)(n.strong,{children:"Settings"}),' and point "Shortcuts template file" to ',(0,r.jsx)(n.code,{children:"BQL_Shortcuts.md"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"3-use",children:"3. Use"}),"\n",(0,r.jsx)(n.p,{children:"Now you can simply write:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["My net worth is ",(0,r.jsx)(n.code,{children:"bql-sh:WORTH"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function c(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);